/*TRANSACTION: Insertion of a musical album from a new artist.*/

BEGIN TRANSACTION INSERT_ALBUM
	INSERT INTO PERSON VALUES ('NAME', 'YYYY-MM-DD', NEW UNQIUE ID);
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO MUSICAL_ARTIST VALUES(NEW UNIQUE ID, 'SPOTIFY URL', 'AM URL');
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO MEDIA_ITEM VALUES('ALBUM TITLE', 'DOI', 'PUB. DATE');
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO MUSICAL ALBUM VALUES('RUNTIME','RECORD LABEL', 'GENRE','NEW UNIQUE ID', 'DOI');
	IF error THEN GO TO UNDO; END IF;
	COMMIT;
	GO TO FINISH;
	UNDO:
		ROLLBACK;
	FINISH:
END TRANSACTION;

/*TRANSACTION: Insertion of an audiobook with corresponding chapters.*/

BEGIN TRANSACTION INSERT_AB_WITH_CHAPTERS
	INSERT INTO MEDIA_ITEM VALUES('AB TITLE', 'DOI', 'PUB.DATE');
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO AUDIOBOOK VALUES('LENGTH', 'GENRE', 'AUTHOR LIB.ID', 'NARRATOR LIB.ID', 'DOI');
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO BOOK_CHAPTER VALUES('CHP NAME', 'INDEX', 'HH:MM:SS', 'DOI');
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO BOOK_CHAPTER VALUES('CHP NAME', 'INDEX', 'HH:MM:SS', 'DOI');
	IF error THEN GO TO UNDO; END IF;
	INSERT INTO BOOK_CHAPTER VALUES('CHP NAME', 'INDEX', 'HH:MM:SS', 'DOI');
	IF error THEN GO TO UNDO; END IF;
	/*INSERT DESIRED NUMBER OF CHAPTERS*/
	COMMIT;
	GO TO FINISH;
	UNDO:
		ROLLBACK;
	FINISH:
END TRANSACTION;


/*TRANSACTION: Return a checked out item.*/

BEGIN TRANSACTION RETURN_ITEM
	INSERT INTO RETURN VALUES('COPY TO RETURN', 'PATRON ID', 'CHECKOUT DATE', 'CURRENT DATE');
	IF error THEN GO TO UNDO; END IF;
	UPDATE COPY SET patron_id=NULL, checkout_date=NULL
	WHERE inventory_number='COPY TO RETURN';
	IF error THEN GO TO UNDO; END IF;
	COMMIT;
	GO TO FINISH;
	UNDO:
		ROLLBACK;
	FINISH:
END TRANSACTION;






